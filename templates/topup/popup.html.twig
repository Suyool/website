{% extends 'base.html.twig' %}

{% block body %}
	<div class="entireBody">
		<div class="desktopMode desktop-logo">
			<img src="{{asset('build/images/payment/nonsuyooler-flow-suyool-cover-desktop.svg')}}" alt="" class="topiveri" width="100%">
		</div>
		<div class="popup">
			<div class="image">
				<img src="{{ asset(imgsrc) }}" alt="">
			</div>
			<div class="title">
				{{title}}
			</div>
			<div class="desc">
				{{description|raw}}
			</div>
			<div class="button">
				{% if redirectCallBack is defined and redirectCallBack == true  %}
					<button class="action">
						<a href="{{redirect}}">{{button}}</a>
					</button>
				{% elseif redirectCallBack is defined and redirectCallBack == false %}
					<button class="action">
						{{button}}
					</button>
				{% elseif redirect is defined and redirect is not null %}
					<button class="action">
						<a href="{{app.request.schemeAndHttpHost}}/{{redirect}}">{{button}}</a>
					</button>
				{% else %}
					<button class="action {% if infoSuccess is defined and infoSuccess == true %}actionAppSuccess{% elseif infoFailed is defined and infoFailed == true %}actionAppFailed{% else %}actionBrowser{% endif %}">
						{{button}}
					</button>
				{% endif %}
			</div>
		</div>
	</div>
	{% if redirectCallBack is defined %}
	<script>
		// Check if redirectCallBack is defined and redirectURL is not null
		var redirectCallBack = {{ redirectCallBack|default('false') }};
		var redirectURL = "{{ redirect|default('') }}";

		if (typeof redirectCallBack !== 'undefined' && redirectURL !== '') {
				redirectURL = redirectURL.replace(/&amp;/g, '&');
				window.location.href = redirectURL;
		}
	</script>
	{% endif %}

	{% if app.request.cookies.get('shopifyCardPayment') is defined and app.request.cookies.get('shopifyCardPayment') == true %}
		<script>
			function checkOrderStatus(order_id) {
				$.ajax({
					type: "post",
					url: "{{ path('app_check_status', { orderId: order_id }) }}",
					success: function(data) {
						if (data.status === 1) {
							// Order status is 1
							window.location.href = data.url;
						}
						if (data.status === 2) {
							// Order status is 2
							window.location.href = data.url;
						}
					}
				});
			}

			$(document).ready(function() {
				setInterval(function() {
					// Call the checkOrderStatus function
					checkOrderStatus({{ order_id }});
				}, 3000); // Check order status every 3 seconds
			});
		</script>

	{% endif %}
{% endblock %}
